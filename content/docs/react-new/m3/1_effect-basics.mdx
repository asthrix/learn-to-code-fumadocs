---
title: "Effect Basics & Data Lifecycles"
description:
   "Learn when to use `useEffect`, manage dependency arrays, and avoid common
   pitfalls."
module: "M3"
lesson: "1"
difficulty: "intermediate"
duration: "30"
project_phase: "Data"
prerequisites: ["/docs/react-new/m3/0_index"]
learning_objectives:
   - "Explain when side effects are required in React"
   - "Use `useEffect` with correct dependency arrays"
   - "Clean up subscriptions or listeners to avoid leaks"
tags: ["useEffect", "hooks", "lifecycle"]
---

import { Accordions, Accordion } from "@/components/accordion";

# Effect Basics & Data Lifecycles

`useEffect` runs side-effects after render—perfect for fetching listings. Before
hitting the API, understand the lifecycle so you can reason about re-renders.

---

## 1. When to Reach for useEffect

Use effects for:

-  Fetching remote data.
-  Subscribing to external services (e.g., websockets).
-  Interacting with browser APIs (e.g., `localStorage`, `document.title`).

Avoid effects for data that can be derived synchronously from props or state.

---

## 2. Example: Synchronising Document Title

```tsx
import { useEffect } from "react";

export function SavedBanner({ savedCount }: { savedCount: number }) {
   useEffect(() => {
      document.title = savedCount
         ? `StaySense · ${savedCount} saved`
         : "StaySense · Boutique stays";
   }, [savedCount]);

   return null;
}
```

Dependencies ensure the effect only runs when `savedCount` changes.

---

## 3. Cleanup Functions

Return a cleanup function when the effect creates subscriptions or timeouts:

```tsx
useEffect(() => {
   const timer = window.setInterval(() => console.count("render"), 5000);
   return () => window.clearInterval(timer);
}, []);
```

---

## Task · Log Filter Analytics Responsibly

Practice `useEffect` by logging filter usage in development mode.

1. Create `src/hooks/useFilterAnalytics.ts` exporting a `useFilterAnalytics`
   hook that accepts the current filter state (search, categories, price,
   guests).
2. Inside the hook, use `useEffect` to `console.info` the filter snapshot when
   any value changes (development mode only).
3. Call the hook from `ListingSection`.
4. Commit with `git commit -am "chore: add filter analytics hook"`.

<Accordions type='single' className='mt-4'>
   <Accordion title='Solution Walkthrough'>
      ```tsx
      // src/hooks/useFilterAnalytics.ts
      import { useEffect } from "react";

      type FilterAnalyticsArgs = {
         search: string;
         categories: string[];
         maxPrice: number;
         guests: number;
      };

      export function useFilterAnalytics({ search, categories, maxPrice, guests }: FilterAnalyticsArgs) {
         useEffect(() => {
            if (!import.meta.env.DEV) return;
            console.info("[StaySense] filters", {
               search,
               categories,
               maxPrice,
               guests,
            });
         }, [search, categories, maxPrice, guests]);
      }
      ```

      ```tsx
      // src/components/ListingSection.tsx
      import { useFilterAnalytics } from "../hooks/useFilterAnalytics";

      export function ListingSection(/* props */) {
         useFilterAnalytics({
            search,
            categories: activeCategories,
            maxPrice,
            guests,
         });
         /* rest of component */
      }
      ```

      ```bash
      git add src/hooks/useFilterAnalytics.ts src/components/ListingSection.tsx
      git commit -m "chore: add filter analytics hook"
      ```

   </Accordion>
</Accordions>

---

## ✅ Validation Checklist

-  [ ] Explain when to use `useEffect` vs derived state.
-  [ ] Hook logs filter changes only in development mode.
-  [ ] No memory leaks or runaway intervals.
