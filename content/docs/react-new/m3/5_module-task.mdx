---
title: "Module Task · API-Driven Listings"
description:
   "Finalize the API integration with resilient UX, capture release notes, and
   validate behaviour."
module: "M3"
lesson: "5"
difficulty: "intermediate"
duration: "45"
project_phase: "Data"
prerequisites:
   [
      "/docs/react-new/m3/1_effect-basics",
      "/docs/react-new/m3/2_mock-api-fetching",
      "/docs/react-new/m3/3_loading-and-errors",
      "/docs/react-new/m3/4_shared-context",
   ]
learning_objectives:
   - "Confirm the mock API powers StaySense listings end to end"
   - "Polish loading, empty, and error states"
   - "Explain the data flow in documentation"
tags: ["project", "api", "effects"]
---

import { Accordions, Accordion } from "@/components/accordion";

# Module Task · API-Driven Listings

Your goal: prove StaySense functions purely on remote data while maintaining a
smooth user experience.

---

## Milestone Requirements

1. **API powered**: No static fallback data remains in `ListingSection`.
2. **UX states**: Loading skeletons, empty state, and error view all trigger as
   expected.
3. **Context**: Listings flow through `ListingsProvider`; consumers use hooks.
4. **Docs**: Data flow recorded in release notes with diagrams or bullet lists.

---

## Task · Ship & Document the Integration

1. Remove any leftover direct imports of `featuredListings` from UI components.
2. Add an empty state CTA button to retry fetch or clear filters.
3. Create `docs/releases/m3-api-integration.md` outlining the request lifecycle
   (component → hook → API → response).
4. Capture a short Loom or screenshot sequence showing loading → success states
   (link in release notes).
5. Commit with `git commit -am "feat: complete api-driven listings"`.

<Accordions type='single' className='mt-4'>
   <Accordion title='Solution Outline'>
      ```tsx
      // src/components/ListingSection.tsx (empty state CTA example)
      {status === "success" && !listings.length && (
         <div className='col-span-full rounded-2xl border border-dashed border-white/20 bg-white/5 p-10 text-center text-slate-300'>
            <p className='text-lg font-semibold text-white'>No stays match your filters.</p>
            <button
               type='button'
               onClick={() => {
                  onSearchChange("");
                  onMaxPriceChange(400);
                  onGuestsChange(2);
                  onCategoryChange("All");
               }}
               className='mt-4 rounded-full bg-emerald-400 px-6 py-2 text-sm font-medium text-emerald-950 hover:bg-emerald-300'
            >
               Reset filters
            </button>
         </div>
      )}
      ```

      ```md
      <!-- docs/releases/m3-api-integration.md -->
      # Module 3 · API Integration

      ## Flow
      1. `App` passes filter params to `ListingsProvider`.
      2. `useListings` issues GET `/api/listings` with axios-mock-adapter.
      3. Mock adapter filters seeded listings and returns JSON.
      4. Provider caches listings and exposes `refresh`.
      5. UI renders skeletons, then data, or error/empty states.

      ## Evidence
      - Loom: https://loom.com/share/staysense-api-demo (shows loading → populated grid)
      - Screenshot: `docs/releases/screenshots/m3-api.png`

      ## Known Limitations
      - Listings re-fetch on every filter change (acceptable for mock data).
      - Auth not implemented—public endpoints only.
      ```

      ```bash
      git add src/components/ListingSection.tsx docs/releases/m3-api-integration.md
      git commit -m "feat: complete api-driven listings"
      ```

   </Accordion>
</Accordions>

---

## ✅ Module 3 Validation Checklist

-  [ ] Listings load via API with network delay simulated.
-  [ ] User sees skeletons, data, empty prompts, and retry flows working.
-  [ ] Release notes explain the effect/data flow clearly.
