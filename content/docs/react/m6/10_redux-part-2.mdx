---
title: "Redux Part 2"
description:
   "Author reducers, selectors, and memoised derived data for TaskFlow Pro."
module: "M6"
lesson: "10"
difficulty: "advanced"
duration: "40"
project_phase: "Global state"
prerequisites: ["/docs/react/m6/9_redux-part-1"]
learning_objectives:
   - "Implement reducers with Redux Toolkit slices"
   - "Create memoised selectors for projects and tasks"
   - "Normalise entity state for faster lookups"
   - "Write smoke tests for reducers and selectors"
tags: ["redux", "selectors", "state-management"]
---

import { Accordions, Accordion } from "@/components/accordion";

# Redux Part 2

## Learning Objectives

By the end of this lesson, you will:

-  [ ] Build Redux Toolkit slices with entity adapters.
-  [ ] Expose selectors that power memoised UI.
-  [ ] Normalise project/task data for predictable updates.
-  [ ] Test reducers and selectors for confidence.

## Entity Adapters

```tsx
import { createEntityAdapter, createSlice } from "@reduxjs/toolkit";

type Project = { id: string; name: string; status: "active" | "archived" };

const projectsAdapter = createEntityAdapter<Project>();

const projectsSlice = createSlice({
   name: "projects",
   initialState: projectsAdapter.getInitialState(),
   reducers: {
      upsertMany: projectsAdapter.upsertMany,
      removeOne: projectsAdapter.removeOne,
      setAll: projectsAdapter.setAll,
   },
});

export const { upsertMany, removeOne, setAll } = projectsSlice.actions;
export const projectsReducer = projectsSlice.reducer;
```

---

## Memoised Selectors

```tsx
import { createSelector } from "@reduxjs/toolkit";

const selectProjectsState = (state: RootState) => state.projects;

export const { selectAll: selectAllProjects, selectById: selectProjectById } =
   projectsAdapter.getSelectors(selectProjectsState);

export const selectActiveProject = createSelector(
   [selectProjectsState, (_: RootState, activeId: string | null) => activeId],
   (projectsState, activeId) =>
      activeId
         ? projectsAdapter.getSelectors().selectById(projectsState, activeId)
         : null
);
```

-  Rely on `createSelector` for derived data shared across views.
-  Accept props (like `activeId`) as selector arguments.

---

## Testing Reducers

```tsx
it("sets projects from payload", () => {
   const next = projectsReducer(
      undefined,
      setAll([{ id: "acme", name: "Acme" }])
   );
   expect(selectAllProjects({ projects: next } as RootState)).toHaveLength(1);
});
```

-  Keep reducer tests lightweight and focused on behaviour.
-  Selector tests ensure memoisation works with props.

<Accordions type='single' className='mt-4'>
   <Accordion title='TaskFlow Pro Upgrades'>
      <p>Implement slices and selectors for real data.</p>

      ```tsx filename="src/state/tasksSlice.ts"
      import { createEntityAdapter, createSlice } from "@reduxjs/toolkit";

      const tasksAdapter = createEntityAdapter<Task>({ sortComparer: (a, b) => a.createdAt.localeCompare(b.createdAt) });

      const tasksSlice = createSlice({
         name: "tasks",
         initialState: tasksAdapter.getInitialState({ activeProjectId: null as string | null }),
         reducers: {
            setActiveProject(state, action: PayloadAction<string | null>) {
               state.activeProjectId = action.payload;
            },
            upsertMany: tasksAdapter.upsertMany,
         },
      });
      ```

   </Accordion>
</Accordions>

---

## âœ… Validation Checklist

-  [ ] Slices use entity adapters for efficient updates.
-  [ ] Selectors memoise derived data and accept props where needed.
-  [ ] Reducer and selector tests pass.

---

